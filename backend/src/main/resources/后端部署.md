# 后端本地部署文档
## 1.后端从workOrder拉取最新代码，前端从dev拉取联调代码。
## 2.确认运行环境已经下载：编译器Idea+jdk17+MySQL
## 3.构建maven依赖:运行mvn clean , mvn install
## 4.idea连接本地MySQL数据库，执行workorder.sql文件。
## 5.运行SpringVueDemoApplication.java文件，用postman发请求，端口号8080.
- 请求参数参照接口文档，注意有的参数必填。
- 请求url样例：http://localhost:8080/workOrder/page。

## 功能测试

1. ***登录功能***：用户可以通过工号或者手机号进行登录，判断密码是否正确，若校验成功则生成jwt令牌返回前端，jwt令牌保存用户的个人信息，此后用户每次请求都要在请求头中增加jwt令牌拦截器会通过令牌判断用户状态，可以维持一段时间的登录状态，超过一天则自动退出登录  
   执行最新的workOrder.sql,需要先在staff表中插入一个用户数据，注意有些字段不能为空
postman测试：
![登录接口](img/登录接口.jpg)

![用户个人信息接口，后续会补充更多字段](img/获取用户个人信息的接口.png)

---
2. ***工单系统*** 


***（1）新增工单***   
a. 输入: 工单类型，工单标题，内容，优先级，指定的派发人和验收人  
b. 返回值：工单id，工单编号，指定的审核人id

***（2)转发给审核人***  
a. 输入： 工单id，工单编号，指定的审核人id，操作类型：8（表示审核操作）   
b. 输出：工单id，工单编号，isSuccess（表示是否成功）
（备注：前端点击“创建工单”按钮，调用这两个接口）

***（3）审核***  
a. 输入：工单id，工单编号，审核意见，备注  
b. 返回值：工单id，工单编号，审核结果（表示审核是否结束，false表示未结束，true表示已结束），下一个审核人id，如果不存在则返回null  
（备注：审核不通过或者最上级审核人已经同意，审核流程结束；如果流程未结束，依次调用“转发给审核人——审核人审批”两个步骤）

---
postman中对应的测试样例所需要的数据在resource文件夹的organization.sql文件中，直接执行就好
